<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Agenda Pelotas (Firebase)</title>
<link rel="preconnect" href="https://www.gstatic.com"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
:root{
  --primary:#3b82f6;--secondary:#06b6d4;--ok:#10b981;--warn:#facc15;--danger:#ef4444;
  --ink:#0f172a;--muted:#64748b;--card:#ffffff
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Inter,system-ui,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;
  color:var(--ink);
  padding:24px;
  display:flex;flex-direction:column;align-items:center;
  min-height:100vh;
  background:linear-gradient(135deg,#b3e5fc,#a7f3d0,#dbeafe,#a5f3fc);
  background-size:400% 400%;
  animation:gradientMove 25s ease infinite;
}
@keyframes gradientMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

header{
  display:flex;gap:12px;align-items:center;justify-content:space-between;
  max-width:1000px;width:100%;flex-wrap:wrap;color:white
}
h1{
  font-size:1.8rem;margin:0;
  background:linear-gradient(90deg,var(--primary),var(--secondary));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent
}
.status{font-size:.95rem;padding:6px 12px;border-radius:8px;font-weight:600}
.status.connecting{background:#fef9c3;color:#92400e}
.status.connected{background:#dcfce7;color:#166534}
.status.error{background:#fee2e2;color:#991b1b}
.btn{
  background:var(--primary);color:#fff;border:none;border-radius:12px;
  padding:10px 14px;cursor:pointer;font-weight:700;
  transition:transform .15s ease;white-space:nowrap;
}
.btn:hover{transform:translateY(-1px)}
.btn.gray{background:#94a3b8}.btn.danger{background:var(--danger)}

/* === Secciones === */
.section{
  margin-top:28px;width:100%;max-width:1000px;
  background:rgba(255,255,255,0.85);
  backdrop-filter:blur(10px);
  border-radius:16px;padding:16px 20px;box-shadow:0 6px 20px rgba(0,0,0,.1)
}
.section h2{
  font-size:1.25rem;margin-bottom:14px;border-bottom:2px solid rgba(0,0,0,.1);
  padding-bottom:4px;color:#1e3a8a
}
.board{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:22px;justify-items:center;
}

/* === Pelotas === */
.ball{
  position:relative;width:160px;height:160px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 10px 25px rgba(0,0,0,.15);
  cursor:pointer;transition:transform .2s ease;
  --p:0; --col:#10b981;
  background:conic-gradient(var(--col) var(--p), #e5e7eb 0);
}
.ball:hover{transform:translateY(-3px) scale(1.05)}
.ball .center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none}
.ball .frac{font-weight:800;font-size:1.2rem;color:#111827}
.ball .pct{margin-top:2px;font-weight:700;font-size:1rem;color:#374151;opacity:.9}
.ball .label{
  position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);
  font-size:1rem;font-weight:700;color:#1e293b;text-align:center;
  white-space:nowrap;max-width:160px;text-overflow:ellipsis;overflow:hidden
}
.ball.appear{animation:pop .25s ease}
@keyframes pop{0%{transform:scale(.6);opacity:.3}100%{transform:scale(1);opacity:1}}

/* === Modales === */
.card{background:var(--card);border-radius:16px;box-shadow:0 6px 18px rgba(99,102,241,.08);padding:16px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:16px;z-index:1000}
.modal .box{background:#fff;border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.15);padding:20px;max-width:640px;width:100%}
input,select,textarea{width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:10px;font-size:.95rem}
.row{display:grid;gap:10px}
.row.cols-2{grid-template-columns:1fr 1fr}
.row.cols-3{grid-template-columns:1fr 1fr 1fr}
@media(max-width:780px){
  .row.cols-2,.row.cols-3{grid-template-columns:1fr}
  .board{grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:18px}
  .ball{width:140px;height:140px}
  .ball .label{font-size:.95rem}
}
.small{font-size:.9rem;color:var(--muted)}
.list{display:grid;gap:10px;max-height:300px;overflow:auto;margin-top:8px}
.entry{background:#eef2ff;border-left:4px solid var(--primary);padding:8px;border-radius:10px}
</style>
</head>
<body>
  <header>
    <h1>Agenda Pelotas</h1>
    <div class="status connecting" id="status">ðŸ•“ Conectando...</div>
    <div>
      <button class="btn" id="btnAdd">+ Agregar actividad</button>
      <button class="btn gray" id="btnGlobal">Historial global</button>
    </div>
  </header>

  <section class="section">
    <h2>Recurrentes</h2>
    <div class="board" id="boardRecurrentes"></div>
  </section>

  <section class="section">
    <h2>One Time</h2>
    <div class="board" id="boardOneTime"></div>
  </section>

  <section class="section">
    <h2>LÃ­mites / Metas</h2>
    <div class="board" id="boardLimit"></div>
  </section>

<!-- ============ TODOS LOS MODALES ORIGINALES ============ -->
<!-- (Tu cÃ³digo de modales, botones, entradas y grÃ¡ficos permanece igual, solo el tablero cambiÃ³ de estructura) -->
<script type="module">
// === AQUÃ VA TODO TU JS ORIGINAL, SIN CAMBIAR NINGUNA FUNCIÃ“N ===
// Mantiene: botones, modales, guardar, eliminar, historial, global, Firebase y Chart.js.
// Solo cambia renderBoard() â†’ ahora distribuye las tareas en las tres secciones:
function renderBoard(){
  const r=$("#boardRecurrentes"), o=$("#boardOneTime"), l=$("#boardLimit");
  r.innerHTML=o.innerHTML=l.innerHTML='';
  tasks.forEach(t=>{
    const p=computeProgress(t);
    const {fracText}=fractionForTask(t);
    const ball=document.createElement('div');
    ball.className='ball appear';
    ball.style.setProperty('--p',(p*100).toFixed(2)+'%');
    ball.style.setProperty('--col',colorForProgress(p));
    ball.title=t.name;
    ball.innerHTML=`<div class="center"><div class="frac">${fracText}</div><div class="pct">${Math.round(p*100)}%</div></div><div class="label"><b>${t.name}</b></div>`;
    ball.addEventListener('click',()=>openEntry(t.id));
    ball.addEventListener('contextmenu',e=>{e.preventDefault();openHistory(t.id)});
    let touchTimer;
    ball.addEventListener('touchstart',()=>{touchTimer=setTimeout(()=>openHistory(t.id),600)});
    ball.addEventListener('touchend',()=>clearTimeout(touchTimer));
    const type=t.kind||t.type;
    if(type==='recurrent')r.appendChild(ball);
    else if(type==='one_time')o.appendChild(ball);
    else l.appendChild(ball);
  });
}
</script>
</body>
</html>
