<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Agenda</title>
<link rel="preconnect" href="https://www.gstatic.com"/>
<!-- Icono para navegador y home screen -->
<link rel="icon" type="image/png" href="favicon.png" />
<link rel="apple-touch-icon" href="icon-192.png" />
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
:root{
  --primary:#3b82f6;--secondary:#06b6d4;--ok:#10b981;--warn:#facc15;--danger:#ef4444;
  --ink:#0f172a;--muted:#64748b;--card:#ffffff
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Inter,system-ui,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;
  color:var(--ink);
  padding:24px;
  display:flex;flex-direction:column;align-items:center;
  min-height:100vh;
  background:linear-gradient(135deg,#b3e5fc,#a7f3d0,#dbeafe,#a5f3fc);
  background-size:400% 400%;
  animation:gradientMove 25s ease infinite;
  -webkit-text-size-adjust:100%;
}
@keyframes gradientMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

header{
  display:flex;gap:12px;align-items:center;justify-content:space-between;
  max-width:1000px;width:100%;flex-wrap:wrap;color:white
}
h1{
  font-size:1.8rem;margin:0;
  background:linear-gradient(90deg,var(--primary),var(--secondary));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent
}
.status{font-size:.95rem;padding:6px 12px;border-radius:8px;font-weight:600}
.status.connecting{background:#fef9c3;color:#92400e}
.status.connected{background:#dcfce7;color:#166534}
.status.error{background:#fee2e2;color:#991b1b}
.btn{
  background:var(--primary);color:#fff;border:none;border-radius:12px;
  padding:10px 14px;cursor:pointer;font-weight:700;
  transition:transform .15s ease;white-space:nowrap;font-size:0.9rem;
}
.btn:hover{transform:translateY(-1px)}
.btn.gray{background:#94a3b8}
.btn.danger{background:var(--danger)}
.btn-small{padding:6px 10px;font-size:.8rem;border-radius:999px}

/* === Secciones === */
.section{
  margin-top:28px;width:100%;max-width:1000px;
  background:rgba(255,255,255,0.85);
  backdrop-filter:blur(10px);
  border-radius:16px;padding:16px 20px;box-shadow:0 6px 20px rgba(0,0,0,.1)
}
.section h2{
  font-size:1.25rem;margin-bottom:8px;border-bottom:2px solid rgba(0,0,0,.1);
  padding-bottom:4px;color:#1e3a8a
}
.board{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:22px;justify-items:center;
}

/* === Pelotas === */
.ball{
  position:relative;width:160px;height:160px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 10px 25px rgba(0,0,0,.15);
  cursor:pointer;transition:transform .2s ease;
  --p:0; --col:#10b981;
  background:conic-gradient(var(--col) var(--p), #e5e7eb 0);
}
.ball:hover{transform:translateY(-3px) scale(1.05)}
.ball .center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none}
.ball .frac{font-weight:800;font-size:1.1rem;color:#111827}
.ball .pct{margin-top:2px;font-weight:700;font-size:.95rem;color:#374151;opacity:.9}
.ball .label{
  position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);
  font-size:1rem;font-weight:700;color:#1e293b;text-align:center;
  white-space:nowrap;max-width:160px;text-overflow:ellipsis;overflow:hidden
}
.ball.appear{animation:pop .25s ease}
@keyframes pop{0%{transform:scale(.6);opacity:.3}100%{transform:scale(1);opacity:1}}

/* === Modales y tarjetas === */
.card{
  background:var(--card);border-radius:16px;box-shadow:0 6px 18px rgba(99,102,241,.08);padding:16px
}
.card.done{
  border-left:4px solid var(--ok);background:#ecfdf3;
}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:16px;z-index:1000}
.modal.show{display:flex}
.modal .box{background:#fff;border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.15);padding:20px;max-width:640px;width:100%}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.modal-header h3{margin:0;font-size:1.1rem}
.modal-body{display:grid;gap:10px}
input,select,textarea{
  width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:10px;
  font-size:16px; /* 16px para evitar zoom en iPhone */
}
.row{display:grid;gap:10px}
.row.cols-2{grid-template-columns:1fr 1fr}
.row.cols-3{grid-template-columns:1fr 1fr 1fr}
@media(max-width:780px){
  .row.cols-2,.row.cols-3{grid-template-columns:1fr}
  .board{grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:18px}
  .ball{width:140px;height:140px}
  .ball .label{font-size:.95rem}
}
.small{font-size:.9rem;color:var(--muted)}

/* lista genÃ©rica (historial, etc.) */
.list{
  display:flex;
  flex-direction:column;
  gap:10px;
  max-height:300px;
  overflow:auto;
  margin-top:8px;
}

.entry{background:#eef2ff;border-left:4px solid var(--primary);padding:8px;border-radius:10px}
.entry span{display:block;font-size:.85rem}
.badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:.75rem;background:#e5e7eb;color:#111827;margin-left:4px}
h3{margin:0 0 4px 0;font-size:1.05rem}

/* === Pendientes puntuales === */
.todo-item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  background:#f9fafb;
  border-radius:10px;
  padding:8px 10px;
  color:#0f172a;
  font-size:.9rem;
  width:100%; /* clave para ocupar todo el ancho */
}
.todo-label{
  display:flex;
  align-items:center;
  gap:8px;
  cursor:pointer;
  flex:1;
}
.todo-text{
  flex:1;
  word-break:break-word;
}
.todo-item.done .todo-text{
  text-decoration:line-through;
  opacity:.6;
}
.todo-empty{
  background:transparent;
  border-left:none;
  color:var(--muted);
  font-size:.85rem;
}
</style>
</head>
<body>
  <header>
    <h1>Agenda Pelotas</h1>
    <div class="status connecting" id="status">ðŸ•“ Cargando datos locales...</div>
  </header>

  <!-- ========== SECCIÃ“N 1: PRESUPUESTO FINANCIERO ========== -->
  <section class="section">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap">
      <h2>Presupuesto financiero</h2>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn gray" id="btnBudgetConfig">Configurar presupuesto</button>
        <button class="btn" id="btnAddExpense">Agregar gasto</button>
        <button class="btn gray" id="btnExpensesHistory">Historial de gastos</button>
      </div>
    </div>
    <p class="small" id="cycleLabel"></p>
    <div class="board" id="boardBudget"></div>
  </section>

  <!-- ========== SECCIÃ“N 2: RECORDATORIOS ========== -->
  <section class="section">
    <h2>Recordatorios</h2>

    <!-- Rutinas diarias -->
    <div class="row cols-2" id="dailyRow" style="margin-bottom:16px">
      <div class="card" id="morningCard">
        <h3>Rutina MaÃ±ana</h3>
        <p class="small" id="morningStatusText"></p>
        <button class="btn" id="btnMorningToggle">Marcar como hecha</button>
      </div>
      <div class="card" id="nightCard">
        <h3>Rutina Noche</h3>
        <p class="small" id="nightStatusText"></p>
        <button class="btn" id="btnNightToggle">Marcar como hecha</button>
      </div>
    </div>

    <!-- Pendientes puntuales -->
    <div>
      <h3 style="margin-bottom:8px;font-size:1.05rem">Pendientes puntuales</h3>
      <div class="row cols-2" style="align-items:flex-end;margin-bottom:8px">
        <div>
          <label>Nuevo pendiente</label>
          <input type="text" id="todoText" placeholder="Ej: Llamar al banco, enviar correo, etc." />
        </div>
        <div>
          <button class="btn" id="btnAddTodo">Agregar pendiente</button>
        </div>
      </div>
      <div class="list" id="todoList"></div>
    </div>
  </section>

  <!-- === Modal ConfiguraciÃ³n de presupuesto === -->
  <div class="modal" id="budgetModal">
    <div class="box">
      <div class="modal-header">
        <h3>Configurar presupuesto del ciclo</h3>
        <button class="btn gray" id="budgetClose">Cerrar</button>
      </div>
      <div class="modal-body">
        <p class="small" id="budgetCycleLabel"></p>
        <div class="row cols-2">
          <div>
            <label>Ocio / Deporte</label>
            <input type="number" id="budget_ocio" min="0" step="1000" placeholder="Monto en CLP" />
          </div>
          <div>
            <label>Oficina</label>
            <input type="number" id="budget_oficina" min="0" step="1000" placeholder="Monto en CLP" />
          </div>
        </div>
        <div class="row cols-2">
          <div>
            <label>Extras</label>
            <input type="number" id="budget_extras" min="0" step="1000" placeholder="Monto en CLP" />
          </div>
          <div>
            <label>Otros</label>
            <input type="number" id="budget_otros" min="0" step="1000" placeholder="Monto en CLP" />
          </div>
        </div>
        <div class="row" style="margin-top:10px;display:flex;gap:8px;justify-content:flex-end">
          <button class="btn" id="budgetSave">Guardar presupuesto</button>
        </div>
      </div>
    </div>
  </div>

  <!-- === Modal Agregar gasto === -->
  <div class="modal" id="expenseModal">
    <div class="box">
      <div class="modal-header">
        <h3>Agregar gasto</h3>
        <button class="btn gray" id="expenseClose">Cerrar</button>
      </div>
      <div class="modal-body">
        <div class="row cols-2">
          <div>
            <label>Fecha</label>
            <input type="date" id="expenseDate" />
          </div>
          <div>
            <label>Monto</label>
            <input type="number" id="expenseAmount" min="0" step="1000" />
          </div>
        </div>
        <div class="row cols-2">
          <div>
            <label>CategorÃ­a</label>
            <select id="expenseCategory">
              <option value="ocio">Ocio / Deporte</option>
              <option value="oficina">Oficina</option>
              <option value="extras">Extras</option>
              <option value="otros">Otros</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div>
            <label>Comentario</label>
            <textarea id="expenseComment" rows="2" placeholder="Ej: Partido pÃ¡del, compra en librerÃ­a, Uber, etc."></textarea>
          </div>
        </div>
        <div class="row" style="margin-top:10px;display:flex;gap:8px;justify-content:flex-end">
          <button class="btn" id="expenseSave">Guardar gasto</button>
        </div>
      </div>
    </div>
  </div>

  <!-- === Modal Historial de gastos === -->
  <div class="modal" id="expensesModal">
    <div class="box">
      <div class="modal-header">
        <h3>Historial de gastos</h3>
        <button class="btn gray" id="expensesClose">Cerrar</button>
      </div>
      <div class="modal-body">
        <div class="list" id="expensesList"></div>
      </div>
    </div>
  </div>

<script type="module">
/* ==================== ESTADO LOCAL ==================== */
const STORAGE_KEY = 'agendaPelotas_state_v1';
const $ = (sel) => document.querySelector(sel);

const BUDGET_CATEGORIES = [
  { key: 'ocio', label: 'Ocio / Deporte' },
  { key: 'oficina', label: 'Oficina' },
  { key: 'extras', label: 'Extras' },
  { key: 'otros', label: 'Otros' }
];

let state = {
  budgets: {},  // cycleKey -> { ocio, oficina, extras, otros }
  expenses: [], // {id, date, category, amount, comment}
  daily: { morningDoneOn: null, nightDoneOn: null },
  todos: []     // {id, text, done}
};

/* ==================== UTILIDADES ==================== */
function todayStr() {
  const d = new Date();
  return d.toISOString().slice(0,10);
}

function loadState() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (raw) {
      const parsed = JSON.parse(raw);
      state.budgets = parsed.budgets || {};
      state.expenses = parsed.expenses || [];
      state.daily = parsed.daily || { morningDoneOn: null, nightDoneOn: null };
      state.todos = parsed.todos || [];
    }
  } catch (e) {
    console.error('Error leyendo localStorage', e);
    state = {
      budgets: {},
      expenses: [],
      daily: { morningDoneOn: null, nightDoneOn: null },
      todos: []
    };
  }
}

function saveState() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

function cycleKeyFromDate(dateStr) {
  const [y,m,d] = dateStr.split('-').map(Number);
  let year = y;
  let month = m;
  if (d < 19) {
    month -= 1;
    if (month === 0) { month = 12; year -= 1; }
  }
  return `${year}-${String(month).padStart(2,'0')}`;
}

function getCurrentCycleKey() {
  return cycleKeyFromDate(todayStr());
}

function getCycleBounds(cycleKey) {
  const [year, month] = cycleKey.split('-').map(Number);
  const startDate = new Date(year, month - 1, 19);
  let endYear = year;
  let endMonth = month === 12 ? 1 : month + 1;
  if (month === 12) endYear = year + 1;
  const endDate = new Date(endYear, endMonth - 1, 18);
  return { startDate, endDate };
}

function formatDate(d) {
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,'0');
  const day = String(d.getDate()).padStart(2,'0');
  return `${day}-${m}-${y}`;
}

function getBudgetForCycle(cycleKey) {
  const base = state.budgets[cycleKey] || {};
  const res = {};
  BUDGET_CATEGORIES.forEach(cat => {
    res[cat.key] = Number(base[cat.key] || 0);
  });
  return res;
}

function getSpentForCycle(cycleKey) {
  const sums = {};
  BUDGET_CATEGORIES.forEach(cat => sums[cat.key] = 0);
  state.expenses.forEach(e => {
    const key = cycleKeyFromDate(e.date);
    if (key === cycleKey && sums.hasOwnProperty(e.category)) {
      sums[e.category] += Number(e.amount || 0);
    }
  });
  return sums;
}

function colorForProgress(p) {
  if (p >= 0.8) return '#f97316';  // naranjo
  if (p >= 0.5) return '#facc15';  // amarillo
  return '#10b981';                // verde
}

/* ==================== MODALES ==================== */
function openModal(el) {
  el.classList.add('show');
}
function closeModal(el) {
  el.classList.remove('show');
}

/* ==================== PRESUPUESTO: RENDER ==================== */
function renderBudget() {
  const board = $('#boardBudget');
  const cycleLabel = $('#cycleLabel');
  const cycleKey = getCurrentCycleKey();
  const { startDate, endDate } = getCycleBounds(cycleKey);
  const budget = getBudgetForCycle(cycleKey);
  const spent = getSpentForCycle(cycleKey);

  cycleLabel.textContent = `Ciclo actual: ${formatDate(startDate)} al ${formatDate(endDate)} (se reinicia el 19 de cada mes)`;

  board.innerHTML = '';
  BUDGET_CATEGORIES.forEach(cat => {
    const b = budget[cat.key];
    const s = spent[cat.key];
    const ratio = b > 0 ? s / b : 0;
    const p = Math.max(0, Math.min(1, ratio));
    const ball = document.createElement('div');
    ball.className = 'ball appear';
    ball.style.setProperty('--p', (p*100).toFixed(2)+'%');
    const color = ratio > 1 ? '#ef4444' : colorForProgress(p);
    ball.style.setProperty('--col', color);
    ball.title = cat.label;

    const spentStr = Number(s || 0).toLocaleString('es-CL', { maximumFractionDigits: 0 });
    const budgetStr = b ? Number(b).toLocaleString('es-CL', { maximumFractionDigits: 0 }) : '-';
    const pct = b ? Math.round(p*100) : 0;

    ball.innerHTML = `
      <div class="center">
        <div class="frac">${spentStr}/${budgetStr}</div>
        <div class="pct">${pct}%</div>
      </div>
      <div class="label"><b>${cat.label}</b></div>
    `;

    // Click â†’ agregar gasto preseleccionando categorÃ­a
    ball.addEventListener('click', () => openExpenseModal(cat.key));

    // Long press / click derecho â†’ historial filtrado por categorÃ­a
    ball.addEventListener('contextmenu', e => {
      e.preventDefault();
      openExpensesHistory(cat.key);
    });
    let touchTimer;
    ball.addEventListener('touchstart', () => {
      touchTimer = setTimeout(() => openExpensesHistory(cat.key), 600);
    });
    ball.addEventListener('touchend', () => clearTimeout(touchTimer));

    board.appendChild(ball);
  });
}

/* ==================== PRESUPUESTO: CONFIG ==================== */
function openBudgetConfig() {
  const modal = $('#budgetModal');
  const cycleKey = getCurrentCycleKey();
  const { startDate, endDate } = getCycleBounds(cycleKey);
  $('#budgetCycleLabel').textContent =
    `Ciclo actual: ${formatDate(startDate)} al ${formatDate(endDate)} (se guarda solo para este ciclo)`;

  const current = getBudgetForCycle(cycleKey);
  BUDGET_CATEGORIES.forEach(cat => {
    $('#budget_'+cat.key).value = current[cat.key] || '';
  });

  openModal(modal);
}

function saveBudgetFromModal() {
  const cycleKey = getCurrentCycleKey();
  const obj = {};
  BUDGET_CATEGORIES.forEach(cat => {
    obj[cat.key] = Number($('#budget_'+cat.key).value || 0);
  });
  state.budgets[cycleKey] = obj;
  saveState();
  renderBudget();
  closeModal($('#budgetModal'));
}

/* ==================== GASTOS ==================== */
function openExpenseModal(categoryKey = 'ocio') {
  const modal = $('#expenseModal');
  $('#expenseDate').value = todayStr();
  $('#expenseAmount').value = '';
  $('#expenseCategory').value = categoryKey;
  $('#expenseComment').value = '';
  openModal(modal);
}

function saveExpenseFromModal() {
  const date = $('#expenseDate').value || todayStr();
  const amount = Number($('#expenseAmount').value || 0);
  const category = $('#expenseCategory').value;
  const comment = $('#expenseComment').value.trim();

  if (!amount || amount <= 0) {
    alert('Ingresa un monto mayor a 0');
    return;
  }

  state.expenses.push({
    id: crypto.randomUUID(),
    date,
    amount,
    category,
    comment
  });

  saveState();
  renderBudget();
  closeModal($('#expenseModal'));
}

function openExpensesHistory(filterCategory = null) {
  const list = $('#expensesList');
  list.innerHTML = '';

  let items = state.expenses.slice();
  if (filterCategory) {
    items = items.filter(e => e.category === filterCategory);
  }
  items.sort((a,b) => b.date.localeCompare(a.date));

  if (!items.length) {
    const div = document.createElement('div');
    div.className = 'entry';
    div.innerHTML = '<span>No hay gastos registrados.</span>';
    list.appendChild(div);
  } else {
    items.forEach(e => {
      const cycleKey = cycleKeyFromDate(e.date);
      const cat = BUDGET_CATEGORIES.find(c => c.key === e.category);
      const label = cat ? cat.label : e.category;
      const amountStr = Number(e.amount || 0).toLocaleString('es-CL', { maximumFractionDigits: 0 });
      const comment = e.comment ? ` â€” ${e.comment}` : '';
      const div = document.createElement('div');
      div.className = 'entry';
      div.innerHTML = `
        <span><b>${e.date}</b> â€” ${label}</span>
        <span>${amountStr}${comment} <span class="badge">${cycleKey}</span></span>
      `;
      list.appendChild(div);
    });
  }

  openModal($('#expensesModal'));
}

/* ==================== RECORDATORIOS: RUTINAS ==================== */
function renderDaily() {
  if (!state.daily) state.daily = { morningDoneOn: null, nightDoneOn: null };
  const today = todayStr();
  const morningDone = state.daily.morningDoneOn === today;
  const nightDone = state.daily.nightDoneOn === today;

  const morningCard = $('#morningCard');
  const nightCard = $('#nightCard');
  const morningStatus = $('#morningStatusText');
  const nightStatus = $('#nightStatusText');
  const morningBtn = $('#btnMorningToggle');
  const nightBtn = $('#btnNightToggle');

  if (morningDone) {
    morningCard.classList.add('done');
    morningStatus.textContent = 'Completada hoy';
    morningBtn.textContent = 'Desmarcar';
  } else {
    morningCard.classList.remove('done');
    morningStatus.textContent = 'Pendiente hoy';
    morningBtn.textContent = 'Marcar como hecha';
  }

  if (nightDone) {
    nightCard.classList.add('done');
    nightStatus.textContent = 'Completada hoy';
    nightBtn.textContent = 'Desmarcar';
  } else {
    nightCard.classList.remove('done');
    nightStatus.textContent = 'Pendiente hoy';
    nightBtn.textContent = 'Marcar como hecha';
  }
}

function toggleRoutine(which) {
  const today = todayStr();
  if (!state.daily) state.daily = { morningDoneOn: null, nightDoneOn: null };
  if (which === 'morning') {
    state.daily.morningDoneOn = (state.daily.morningDoneOn === today) ? null : today;
  } else {
    state.daily.nightDoneOn = (state.daily.nightDoneOn === today) ? null : today;
  }
  saveState();
  renderDaily();
}

/* ==================== RECORDATORIOS: PENDIENTES ==================== */
function renderTodos() {
  const list = $('#todoList');
  // Filtrar pendientes vacÃ­os por si quedaron de versiones anteriores
  const todos = (state.todos || []).filter(t => t && t.text && t.text.trim().length > 0);
  list.innerHTML = '';

  if (!todos.length) {
    const div = document.createElement('div');
    div.className = 'todo-empty';
    div.textContent = 'No hay pendientes.';
    list.appendChild(div);
    return;
  }

  todos.forEach(todo => {
    const div = document.createElement('div');
    div.className = 'todo-item' + (todo.done ? ' done' : '');

    div.innerHTML = `
      <label class="todo-label">
        <input type="checkbox" data-id="${todo.id}" ${todo.done ? 'checked' : ''} />
        <span class="todo-text">${todo.text}</span>
      </label>
      <button class="btn gray btn-small" data-delete="${todo.id}">Eliminar</button>
    `;

    list.appendChild(div);
  });

  list.querySelectorAll('input[type="checkbox"]').forEach(cb => {
    cb.addEventListener('change', () => {
      toggleTodo(cb.dataset.id, cb.checked);
    });
  });

  list.querySelectorAll('button[data-delete]').forEach(btn => {
    btn.addEventListener('click', () => {
      deleteTodo(btn.dataset.delete);
    });
  });
}

function addTodo() {
  const textEl = $('#todoText');
  const text = textEl.value.trim();
  if (!text) return;
  if (!state.todos) state.todos = [];
  state.todos.push({ id: crypto.randomUUID(), text, done: false });
  textEl.value = '';
  saveState();
  renderTodos();
}

function toggleTodo(id, done) {
  const todo = (state.todos || []).find(t => t.id === id);
  if (!todo) return;
  todo.done = done;
  saveState();
  renderTodos();
}

function deleteTodo(id) {
  state.todos = (state.todos || []).filter(t => t.id !== id);
  saveState();
  renderTodos();
}

/* ==================== INICIALIZACIÃ“N ==================== */
document.addEventListener('DOMContentLoaded', () => {
  loadState();
  renderBudget();
  renderDaily();
  renderTodos();

  const status = $('#status');
  status.classList.remove('connecting');
  status.classList.add('connected');
  status.textContent = 'ðŸ’¾ Datos guardados en este dispositivo';

  // Presupuesto
  $('#btnBudgetConfig').addEventListener('click', openBudgetConfig);
  $('#btnAddExpense').addEventListener('click', () => openExpenseModal());
  $('#btnExpensesHistory').addEventListener('click', () => openExpensesHistory());

  $('#budgetClose').addEventListener('click', () => closeModal($('#budgetModal')));
  $('#budgetSave').addEventListener('click', saveBudgetFromModal);

  $('#expenseClose').addEventListener('click', () => closeModal($('#expenseModal')));
  $('#expenseSave').addEventListener('click', saveExpenseFromModal);

  $('#expensesClose').addEventListener('click', () => closeModal($('#expensesModal')));

  // Rutinas
  $('#btnMorningToggle').addEventListener('click', () => toggleRoutine('morning'));
  $('#btnNightToggle').addEventListener('click', () => toggleRoutine('night'));

  // Pendientes
  $('#btnAddTodo').addEventListener('click', addTodo);
});
</script>
</body>
</html>
